<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=600">
    <title>WebStick host</title>
    <link rel="stylesheet" type="text/css" href="resource/style.css">
</head>

<body>
<div class="gm4html5_div_class" id="gm4html5_div_id">
    <canvas id="canvas" width="992" height="544">
        <p>Your browser doesn't support HTML5 canvas.</p>
    </canvas>
</div>

<!-- Run the game code -->
<script type="text/javascript" src="resource/WebStick.js"></script>
<script>window.onload = GameMaker_Init;</script>
<script src="resource/socket.io.js"></script>
<script>
    const hostname = 'najba'; // typed by user - name of room
    const password = 'dupa'; // typed by user - password to room

    const SERVER_URL = 'http://localhost:3000';
    const roomId = hostname + password;

    const socket = io(SERVER_URL, {query: {roomId, nick: hostname}});

    socket.on('connect', () => {
        console.log('connected!!');
    });

    socket.on('error', (data) => {
        console.log('err', data);
    });

    socket.on('move', (rawMessage) => {
        console.log(rawMessage);
        const msg = JSON.parse(rawMessage);
        if (msg.data.type === 'write') {
            gmCallback.lines_add(rawMessage);
        } else if (msg.data.type === 'clear') {
            gmCallback.lines_clear();
        } else {
            console.error('unknown message type: ' + msg.data.type);
        }
    });
</script>
</body>
</html>


                                           
                                           
